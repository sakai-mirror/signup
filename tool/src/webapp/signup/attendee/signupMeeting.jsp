<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>
<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h"%>
<%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai"%>
<%@ taglib uri="http://myfaces.apache.org/tomahawk" prefix="t"%>
<%-- This file generated by Sakai App Builder --%>

<f:view>
<f:loadBundle basename="messages" var="msgs" />
	<sakai:view_container title="Signup Tool">
		<style type="text/css">
			@import url("/sakai-signup-tool/css/signupStyle.css");
		</style>
		<style type="text/css" media="print">
				@import url("/sakai-signup-tool/css/print.css");
		</style>
			
		<h:form id="signupMeeting">
			<sakai:tool_bar>
				<h:outputLink id="print" value="javascript:window.print();">
					<h:graphicImage url="/images/printer.png"
							alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
				</h:outputLink>
			</sakai:tool_bar>
		</h:form>
		
		<sakai:view_content>
			<h:outputText value="#{msgs.event_error_alerts} #{errorMessageUIBean.errorMessage}"
				styleClass="alertMessage" escape="false"
				rendered="#{errorMessageUIBean.error}" />

			<h:form id="meeting">
				<sakai:view_title value="#{msgs.event_participant_view_page_title}" />

				<sakai:messages />

				<h:panelGrid columns="2" columnClasses="titleColumn,valueColumn">
					<h:outputText value="#{msgs.event_name}" styleClass="titleText" escape="false"/>
					<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.meeting.title}"
						styleClass="longtext" />

					<h:outputText value="#{msgs.event_organizer}" styleClass="titleText" escape="false"/>
					<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.creator}"
						styleClass="longtext" />

					<h:outputText value="#{msgs.event_location}" styleClass="titleText" escape="false"/>
					<h:outputText
						value="#{AttendeeSignupMBean.meetingWrapper.meeting.location}"
						styleClass="longtext" />

					<h:outputText value="#{msgs.event_date}" styleClass="titleText" escape="false"/>
					<h:outputText
						value="#{AttendeeSignupMBean.meetingWrapper.meeting.startTime}" styleClass="longtext">
						<f:convertDateTime dateStyle="full"/>
					</h:outputText>
					
					<h:outputText value="#{msgs.event_time_period}" styleClass="titleText" escape="false"/>
					<h:panelGroup>
						<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.meeting.startTime}">
							<f:convertDateTime timeStyle="short" />
						</h:outputText>
						<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.meeting.startTime}" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingCrossDays}">
								<f:convertDateTime pattern=", EEEEEEEE" />
						</h:outputText>	
						<h:outputText value="#{msgs.timeperiod_divider}" escape="false"/>
						<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.meeting.endTime}">
							<f:convertDateTime timeStyle="short" />
						</h:outputText>
						<h:outputText value=",&nbsp;" escape="false" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingCrossDays}"/>
						<h:outputText value="#{AttendeeSignupMBean.meetingWrapper.meeting.endTime}" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingCrossDays}" >
								<f:convertDateTime dateStyle="full"/>
						</h:outputText>	
					</h:panelGroup>	

					<h:outputText value="#{msgs.event_signup_start}" style="white-space: nowrap;" styleClass="titleText" rendered="#{!AttendeeSignupMBean.announcementType}" escape="false"/>
					<h:outputText
						value="#{AttendeeSignupMBean.meetingWrapper.meeting.signupBegins}"
						styleClass="longtext" rendered="#{!AttendeeSignupMBean.announcementType}">
						<f:convertDateTime dateStyle="full" timeStyle="short" type="both"/>
					</h:outputText>

					<h:outputText value="#{msgs.event_signup_deadline}" style="white-space: nowrap;" styleClass="titleText" rendered="#{!AttendeeSignupMBean.announcementType}" escape="false"/>
					<h:outputText
						value="#{AttendeeSignupMBean.meetingWrapper.meeting.signupDeadline}"
						styleClass="longtext" rendered="#{!AttendeeSignupMBean.announcementType}">
						<f:convertDateTime dateStyle="full" timeStyle="short" type="both"/>
					</h:outputText>
					
					<h:outputText value="#{msgs.event_status}" styleClass="titleText" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.passedDeadline || !AttendeeSignupMBean.meetingWrapper.meeting.startToSignUp}" escape="false"/>
					<h:outputText value="#{msgs.event_not_start_signup_process}" styleClass="longtext" escape="false"  rendered="#{!AttendeeSignupMBean.meetingWrapper.meeting.startToSignUp}"/>
					<h:outputText value="#{msgs.event_passed_deadline}" styleClass="longtext" escape="false"  rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.passedDeadline && !AttendeeSignupMBean.meetingWrapper.meeting.meetingExpired}"/>
					<h:outputText value="#{msgs.event_isOver}" styleClass="longtext" escape="false"  rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingExpired && AttendeeSignupMBean.meetingWrapper.meeting.passedDeadline}"/>
					
					<h:outputText value="#{msgs.event_description}" styleClass="titleText" escape="false"/>
					<h:outputText
						value="#{AttendeeSignupMBean.meetingWrapper.meeting.description}"
						escape="false" styleClass="longtext" />
						
					<h:outputText value="&nbsp;" escape="false"/>
					<h:outputText value="&nbsp;" escape="false"/>
				</h:panelGrid>
								
				<h:panelGrid rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingType =='announcement'}" columns="1" styleClass="annoncement">
					<h:outputText value="#{msgs.event_is_open_session}" escape="false" />
				</h:panelGrid>
				
				<h:dataTable id="timeslots" value="#{AttendeeSignupMBean.timeslotWrappers}"
					binding="#{AttendeeSignupMBean.timeslotWrapperTable}" var="timeSlotWrapper"
					rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingType !='announcement'}"
					columnClasses="attendeeSignupTSCol,attendeeSignupAvailCol,attendeeInfoCol,attendeeSignupCol,attendeeSignupCol"
					rowClasses="oddRow,evenRow"
					styleClass="signupTable" style="width: 98%">
					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msgs.tab_time_slot}" />
						</f:facet>
						<h:panelGroup>
							<h:graphicImage value="/images/spacer.gif" width="15" height="13" alt="spacer" style="border:none" rendered="#{!timeSlotWrapper.timeSlot.locked && !timeSlotWrapper.timeSlot.canceled && AttendeeSignupMBean.meetingWrapper.atleastOneTimeslotLockedOrCanceled}"/>
							<h:graphicImage value="/images/lock.gif"  alt="#{msgs.event_tool_tip_ts_locked}" title="#{msgs.event_tool_tip_ts_locked}" style="border:none" rendered="#{timeSlotWrapper.timeSlot.locked && !timeSlotWrapper.timeSlot.canceled}"/>
							<h:graphicImage value="/images/cancelled.gif"  alt="#{msgs.event_tool_tip_ts_cancelled}" style="border:none" rendered="#{timeSlotWrapper.timeSlot.canceled}"/>							
							<h:outputText value="#{timeSlotWrapper.timeSlot.startTime}"
								styleClass="longtext">
								<f:convertDateTime timeStyle="short"/>
							</h:outputText>
							<h:outputText value="#{timeSlotWrapper.timeSlot.startTime}" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingCrossDays}">
								<f:convertDateTime pattern=", EEE" />
							</h:outputText>	
							<h:outputText value="#{msgs.timeperiod_divider}" escape="false"
								styleClass="longtext" />
							<h:outputText value="#{timeSlotWrapper.timeSlot.endTime}"
								styleClass="longtext">
								<f:convertDateTime timeStyle="short"/>
							</h:outputText>
							<h:outputText value="#{timeSlotWrapper.timeSlot.endTime}" rendered="#{AttendeeSignupMBean.meetingWrapper.meeting.meetingCrossDays}">
								<f:convertDateTime pattern=", EEE" />
						</h:outputText>	
						</h:panelGroup>
					</h:column>

					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msgs.tab_event_available_slots}" escape="false"/>
						</f:facet>
						<h:panelGroup rendered="#{timeSlotWrapper.timeSlot.locked && !timeSlotWrapper.timeSlot.canceled}">				
							<h:outputText  value="#{msgs.event_locked}" escape="false" />
						</h:panelGroup>
						<h:panelGroup rendered="#{timeSlotWrapper.timeSlot.canceled}">
							<h:outputText styleClass="attendee_canceled" value="#{msgs.event_canceled}" escape="false" />
						</h:panelGroup>
						<h:panelGroup rendered="#{!timeSlotWrapper.timeSlot.locked && !timeSlotWrapper.timeSlot.canceled}">
								<h:panelGroup rendered="#{!timeSlotWrapper.timeSlot.unlimitedAttendee}">
										<h:outputText value="#{timeSlotWrapper.availability}"
											rendered="#{timeSlotWrapper.availability >0}" styleClass="longtext"/>
										<h:outputText value="#{msgs.event_ts_availability_none}"
											rendered="#{timeSlotWrapper.availability <= 0 && timeSlotWrapper.numberOnWaitingList ==0}" styleClass="longtext"/>
										<h:outputText
											value="#{msgs.event_ts_availability_none} <br>"
											rendered="#{timeSlotWrapper.numberOnWaitingList >0}"
											escape="false"  styleClass="longtext"/>
										<h:outputText
											value="#{timeSlotWrapper.numberOnWaitingList} #{msgs.event_on_waiting}"
											rendered="#{timeSlotWrapper.numberOnWaitingList >0}"
											escape="false"  styleClass="longtext"/>
								</h:panelGroup>
								<h:panelGroup rendered="#{timeSlotWrapper.timeSlot.unlimitedAttendee}">
										<h:outputText value="#{msgs.event_unlimited}" styleClass="longtext"/>									
								</h:panelGroup>
						</h:panelGroup>
					</h:column>
					
					<h:column>		   
							<f:facet name="header">
								<h:outputText value="#{msgs.tab_event_signed_attendee}" escape="false"/>
							</f:facet>
							<h:panelGroup rendered="#{timeSlotWrapper.timeSlot.displayAttendees}">
					   			<h:dataTable id="peopleOnSignup" value="#{timeSlotWrapper.attendeeWrappers}" var="attendeeWrapper">
					   				<h:column>
					   					<h:outputText value="#{attendeeWrapper.displayName}" rendered="#{attendeeWrapper.signupAttendee.attendeeUserId !=null}" title="#{msgs.event_tool_tip_on_signuplist}" styleClass="signedUpList"/>			
					   				</h:column>				   		
					   			</h:dataTable>
					   			<h:dataTable id="peopleOnWaiting" value="#{timeSlotWrapper.waitingList}" var="attendeeWrapper" rendered="#{timeSlotWrapper.sizeOfWaitingList >0}"  styleClass="peopleOnListTable">
					   				<h:column>
					   					<h:outputText value="#{attendeeWrapper.displayName}" rendered="#{attendeeWrapper.signupAttendee.attendeeUserId !=null}" title="#{msgs.event_tool_tip_on_waitinglist}" styleClass="waitingList"/>   					
					   				</h:column>				   		
					   			</h:dataTable>
					   		</h:panelGroup>	
					   		<h:outputText value="#{msgs.event_show_no_attendee_info}" escape="false"  rendered="#{!timeSlotWrapper.timeSlot.displayAttendees}"/>
				   	</h:column>
					

					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msgs.tab_event_your_status}" escape="false"/>
						</f:facet>
						<h:outputText value="#{msgs.event_sign_up}"
							title="#{msgs.event_tool_tip_you_signed_up}"
							rendered="#{timeSlotWrapper.currentUserSignedUp}"
							styleClass="attendee_status" />
						<h:outputText value="#{msgs.event_on_waiting_list}"
							title="#{msgs.event_tool_tip_you_ranking_num} #{timeSlotWrapper.rankingOnWaiting}"
							rendered="#{timeSlotWrapper.currentUserOnWaitingList}"
							styleClass="attendee_status" />
					</h:column>

					<h:column rendered="#{!AttendeeSignupMBean.meetingWrapper.meeting.meetingExpired && AttendeeSignupMBean.meetingWrapper.meeting.permission.attend}">
						<f:facet name="header">
							<h:outputText value="#{msgs.tab_event_action}" escape="false"/>
						</f:facet>
						<sakai:button_bar_item id="addMe" styleClass="actButton"
							action="#{AttendeeSignupMBean.attendeeSignup}" value="#{msgs.event_button_signup}"
							rendered="#{timeSlotWrapper.availableForSignup && !timeSlotWrapper.currentUserSignedUp}"
							disabled="#{!AttendeeSignupMBean.meetingWrapper.meeting.startToSignUp || AttendeeSignupMBean.currentUserSignedup || timeSlotWrapper.currentUserSignedUp ||timeSlotWrapper.timeSlot.locked || timeSlotWrapper.timeSlot.canceled ||AttendeeSignupMBean.meetingWrapper.meeting.passedDeadline}" />
						<sakai:button_bar_item id="Cancel" styleClass="actButton"
							action="#{AttendeeSignupMBean.attendeeCancelSignup}" value="#{msgs.participant_cancel_button}"
							rendered="#{timeSlotWrapper.currentUserSignedUp }" 
							disabled="#{timeSlotWrapper.timeSlot.canceled}"/>
						<sakai:button_bar_item id="addMeOnWaitingList" styleClass="actButton"
							action="#{AttendeeSignupMBean.attendeeAddToWaitingList}" value="#{msgs.add_waitlist_button}" title="#{msgs.tool_tip_add_waitlist}"
							rendered="#{!timeSlotWrapper.currentUserOnWaitingList && !timeSlotWrapper.availableForSignup && !timeSlotWrapper.currentUserSignedUp}" 
							disabled="#{!AttendeeSignupMBean.meetingWrapper.meeting.startToSignUp || timeSlotWrapper.timeSlot.locked || timeSlotWrapper.timeSlot.canceled ||AttendeeSignupMBean.meetingWrapper.meeting.passedDeadline}"/>
						<sakai:button_bar_item id="CancelWaitingList" styleClass="actButton"
							action="#{AttendeeSignupMBean.attendeeRemoveFromWaitingList}" value="#{msgs.remove_waitlist_button}"
							rendered="#{timeSlotWrapper.currentUserOnWaitingList}" 
							disabled="#{timeSlotWrapper.timeSlot.canceled}"/>
					</h:column>

				</h:dataTable>


				<sakai:button_bar>
					<sakai:button_bar_item styleClass="actButton" id="goBack"
						action="listMeetings" value="#{msgs.goback_button}" />
				</sakai:button_bar>

			</h:form>
		</sakai:view_content>
	</sakai:view_container>
</f:view>
